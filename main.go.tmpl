package main

import (
	"github.com/go-redis/redis/v8"

	{{ .TemplatePackages }}
)

type GohmClient struct {
	rdb *redis.Client

	{{ .TemplateGohmFields }}
}

func NewClient(opt *redis.Options) *GohmClient {
	redisClient := redis.NewClient(opt)

	gohmClient := &GohmClient{
		rdb: redisClient, 
		{{ range .Entities }}
		{{- toLower .Name.Name }}: &{{ .Name.Name }}{rdb: redisClient},
		{{ end }}
		}
	
	return gohmClient
}

{{ range .Entities }}
type {{ .Name.Name }} struct {
	rdb *redis.Client
}

func({{ toReceiverCase .Name.Name  }} *{{ .Name.Name }}) Create(ctx context.Context, {{ toLower .Name.Name }} *{{ .NamespacedEntity }}) error {
	panic("not implemented")
}
{{ end }}
